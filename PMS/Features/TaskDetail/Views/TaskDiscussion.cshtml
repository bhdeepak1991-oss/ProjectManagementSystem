@model IEnumerable<PMS.Features.TaskDetail.ViewModels.ProjectDiscussBoard>


@functions {
	string GetColorFromName(string name)
	{
		if (string.IsNullOrEmpty(name)) return "0078D4";
		int hash = name.GetHashCode();
		int hue = Math.Abs(hash % 360); // 0–359
		return $"hsl({hue}, 70%, 50%)"; // HSL supported directly by ui-avatars
	}

	string GetTextColor(string backgroundHsl)
	{
		// Optional: logic to return white or black text depending on background brightness
		return "fff"; // Keep it white for now
	}

	string GetProjectColor(string input)
	{
		int hash = input.GetHashCode();
		byte r = (byte)((hash & 0xFF0000) >> 16);
		byte g = (byte)((hash & 0x00FF00) >> 8);
		byte b = (byte)(hash & 0x0000FF);

		// Brighten color
		r = (byte)((r + 200) / 2);
		g = (byte)((g + 200) / 2);
		b = (byte)((b + 200) / 2);
		var colorHex = $"#{r:X2}{g:X2}{b:X2}";
		return colorHex.Replace("#", ""); ;
	}

}



@foreach (var data in Model)
{
	<div class="TaskDetail-comment" style="position: relative; padding-left: 60px;">
		<!-- Avatar -->
		<img src="https://ui-avatars.com/api/?name=@data.EmployeeName&size=64&background=@GetProjectColor(data.EmployeeName)&color=fff"
			 alt="Avatar"
			 style="width: 40px; height: 40px; border-radius: 50%; position: absolute; top: 12px; left: 12px;" />


		<div class="TaskDetail-commentHeader" style="font-size: 14px; margin-bottom: 4px;">
			<span style="font-weight: 600; color: @GetColorFromName(data.EmployeeName)">
				@data.EmployeeName
			</span>
			<span style="font-weight: 500; color: #999;"> (@data.EmployeeCode)</span>
			<span style="font-weight: normal; color: #666; font-size: 13px;">
				• @data.CreatedDate?.ToString("dd MMM yyyy hh:mm tt")
			</span>
		</div>

		<!-- Comment Body -->
		<div class="TaskDetail-commentBody" style="font-size: 14px; color: #333;">
			@Html.Raw(data.Discussion)
		</div>
	</div>


}