@{
	ViewData["Title"] = "Home Page";
	Layout = "~/Features/shared/ProjectSelectionLayout.cshtml";
}

@functions {
	// Generate a consistent color from project name
	string GetProjectColor(string input)
	{
		int hash = input.GetHashCode();
		byte r = (byte)((hash & 0xFF0000) >> 16);
		byte g = (byte)((hash & 0x00FF00) >> 8);
		byte b = (byte)(hash & 0x0000FF);

		// Brighten color
		r = (byte)((r + 200) / 2);
		g = (byte)((g + 200) / 2);
		b = (byte)((b + 200) / 2);

		return $"#{r:X2}{g:X2}{b:X2}";
	}

	// Determine text color (black or white) based on background brightness
	string GetTextColor(string hex)
	{
		hex = hex.Replace("#", "");
		int r = Convert.ToInt32(hex.Substring(0, 2), 16);
		int g = Convert.ToInt32(hex.Substring(2, 2), 16);
		int b = Convert.ToInt32(hex.Substring(4, 2), 16);
		int brightness = (r * 299 + g * 587 + b * 114) / 1000;
		return brightness > 160 ? "#000000" : "#FFFFFF"; // black if bright, else white
	}
}

<style>
	.info-box {
		border-radius: 8px;
		box-shadow: 0 2px 5px rgba(0,0,0,0.1);
		margin-bottom: 20px;
		transition: transform 0.2s ease-in-out;
		color: white;
	}

		.info-box:hover {
			transform: scale(1.02);
		}

	.info-box-icon img {
		border-radius: 50%;
		border: 2px solid #fff;
	}

	.info-box-content {
		padding-left: 10px;
	}
</style>

@model IEnumerable<PMS.Features.Project.ViewModels.ProjectViewModel>

<div class="content-wrapper">
	<section class="content">


		<div class="row">
			<div class="col-md-12">
				<div class="box">
					<div class="box-header with-border">
						<h3 class="box-title">Project Selection</h3>
						<div class="box-tools pull-right">
							<button class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
						</div>
					</div>
					<div class="box-body">
						<div class="row">
							<div class="col-md-12">
								<p class="text-center">
									<strong>Please select one of the Projects to Proceed in Application</strong>
								</p>
								<div class="row">
									@foreach (var data in Model)
									{
										var name = data?.Name ?? "PMS";
										var colorHex = GetProjectColor(name);
										var textColor = GetTextColor(colorHex);
										var colorHexForUrl = colorHex.Replace("#", "");

										<a asp-action="SelectProject" asp-controller="Dashboard" asp-route-projectId="@data.Id">

											<div class="col-md-4 col-sm-6 col-xs-12">
												<div class="info-box" style="background-color:@colorHex; color:@textColor">
													<span class="info-box-icon">
														<img src="https://ui-avatars.com/api/?name=@(name)&size=400&background=@colorHexForUrl&color=fff"
															 style="height:50px; width:50px;" />
													</span>
													<div class="info-box-content">
														<span class="info-box-text" style="color:@textColor">@data.Name</span>
														<span class="info-box-text" style="color:@textColor">@data.ProjectHead (Project Head)</span>
														<span class="info-box-text" style="color:@textColor">@data.ProjectManager (Project Manager)</span>
														<span class="info-box-text" style="color:@textColor">@data.DeliveryHead (Delivery Head)</span>
													</div>
												</div>
											</div>
										</a>


									}
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>



	</section>
</div>